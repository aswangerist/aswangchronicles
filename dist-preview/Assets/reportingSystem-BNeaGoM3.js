import{d as t}from"./main-Dc76bcfD.js";import{s as e,a as o,c as n}from"./vendor-FisM0nxI.js";import"./bootstrap-BAiwbtED.js";/* empty css                    */import"./utils-C620QYE8.js";import"./components-QOneMgCI.js";class r{constructor(){this.init()}init(){this.addReportButtons()}addReportButtons(){document.addEventListener("click",t=>{if(t&&t.target&&t.target.classList&&t.target.classList.contains("report-comment-btn")){t.preventDefault();const e=t.target.dataset.commentId;this.showReportModal(e)}});const t=new MutationObserver(t=>{t.forEach(t=>{"childList"===t.type&&t.addedNodes.forEach(t=>{t.nodeType===Node.ELEMENT_NODE&&t.classList?.contains("comment-item")&&this.addReportButtonToComment(t)})})}),e=document.getElementById("commentsList");e&&t.observe(e,{childList:!0,subtree:!0})}addReportButtonToComment(t){const e=t.dataset.commentId;if(!e||t.querySelector(".report-comment-btn"))return;const o=t.querySelector(".comment-actions")||t.querySelector(".comment-meta");if(o){const t=document.createElement("button");t.className="btn btn-sm btn-outline-secondary report-comment-btn ms-2",t.dataset.commentId=e,t.innerHTML='<i class="fas fa-flag"></i> Report',t.title="Report inappropriate content",o.appendChild(t)}}showReportModal(t){const e=document.getElementById("reportModal");e&&e.remove();const o=document.createElement("div");o.id="reportModal",o.innerHTML='\n      <div class="modal fade show" style="display: block; background: rgba(0,0,0,0.5);" tabindex="-1">\n        <div class="modal-dialog">\n          <div class="modal-content bg-dark text-light">\n            <div class="modal-header border-secondary">\n              <h5 class="modal-title">\n                <i class="fas fa-flag text-warning"></i> Report Comment\n              </h5>\n              <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>\n            </div>\n            <div class="modal-body">\n              <p>Please help us maintain a safe and respectful community by reporting inappropriate content.</p>\n              \n              <form id="reportForm">\n                <div class="mb-3">\n                  <label class="form-label">Reason for reporting:</label>\n                  <select class="form-select bg-dark text-light border-secondary" id="reportReason" required>\n                    <option value="">Select a reason...</option>\n                    <option value="spam">Spam or unwanted commercial content</option>\n                    <option value="harassment">Harassment or bullying</option>\n                    <option value="inappropriate">Inappropriate or offensive content</option>\n                    <option value="misinformation">False or misleading information</option>\n                    <option value="copyright">Copyright violation</option>\n                    <option value="other">Other (please specify)</option>\n                  </select>\n                </div>\n                \n                <div class="mb-3">\n                  <label for="reportDetails" class="form-label">Additional details (optional):</label>\n                  <textarea \n                    class="form-control bg-dark text-light border-secondary" \n                    id="reportDetails" \n                    rows="3" \n                    placeholder="Please provide any additional context that might help our moderators..."\n                    maxlength="500"\n                  ></textarea>\n                  <div class="form-text text-muted">\n                    <span id="reportCharCount">0</span>/500 characters\n                  </div>\n                </div>\n                \n                <div class="mb-3">\n                  <div class="form-check">\n                    <input class="form-check-input" type="checkbox" id="reportConfirm" required>\n                    <label class="form-check-label text-light" for="reportConfirm">\n                      I confirm that this report is submitted in good faith and the content violates community guidelines.\n                    </label>\n                  </div>\n                </div>\n              </form>\n            </div>\n            <div class="modal-footer border-secondary">\n              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>\n              <button type="button" class="btn btn-warning" id="submitReport">\n                <i class="fas fa-flag"></i> Submit Report\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    ',document.body.appendChild(o);const n=document.getElementById("reportDetails"),r=document.getElementById("reportCharCount");n.addEventListener("input",()=>{r.textContent=n.value.length}),o.querySelector('[data-bs-dismiss="modal"]').addEventListener("click",()=>{o.remove()}),o.querySelector(".btn-close").addEventListener("click",()=>{o.remove()}),o.addEventListener("click",t=>{t.target===o&&o.remove()}),document.getElementById("submitReport").addEventListener("click",()=>{this.submitReport(t,o)}),document.getElementById("reportReason").focus()}async submitReport(r,a){document.getElementById("reportForm");const i=document.getElementById("reportReason").value,s=document.getElementById("reportDetails").value,c=document.getElementById("reportConfirm").checked;if(i)if(c)try{const c={commentId:r,reason:i,details:s.trim(),reportedAt:e(),reporterIP:await this.getReporterInfo(),status:"pending",resolved:!1};await o(n(t,"reports"),c),this.showReportNotification("Thank you for your report. Our team will review it shortly.","success"),a.remove(),this.disableReportButton(r)}catch(d){this.showReportNotification("Failed to submit report. Please try again.","error")}else this.showReportNotification("Please confirm that your report is submitted in good faith","error");else this.showReportNotification("Please select a reason for reporting","error")}async getReporterInfo(){try{const t=await fetch("https://api.ipify.org?format=json");return{ip:(await t.json()).ip,userAgent:navigator.userAgent.substring(0,100),timestamp:(new Date).toISOString()}}catch(t){return{ip:"unknown",userAgent:navigator.userAgent.substring(0,100),timestamp:(new Date).toISOString()}}}disableReportButton(t){const e=document.querySelector(`.report-comment-btn[data-comment-id="${t}"]`);if(e){e.disabled=!0,e.innerHTML='<i class="fas fa-check"></i> Reported',e.classList.remove("btn-outline-secondary"),e.classList.add("btn-outline-success");const o=JSON.parse(localStorage.getItem("reported_comments")||"[]");o.includes(t)||(o.push(t),localStorage.setItem("reported_comments",JSON.stringify(o)))}}checkReportedComments(){JSON.parse(localStorage.getItem("reported_comments")||"[]").forEach(t=>{this.disableReportButton(t)})}showReportNotification(t,e="info"){const o=document.querySelector(".report-notification");o&&o.remove();const n=document.createElement("div");n.className="report-notification",n.innerHTML=`\n      <div style="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: ${"success"===e?"#28a745":"error"===e?"#dc3545":"#007bff"};\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n        z-index: 10000;\n        font-family: var(--font-body);\n        max-width: 350px;\n        animation: slideIn 0.3s ease;\n      ">\n        <i class="fas fa-${"success"===e?"check-circle":"error"===e?"exclamation-triangle":"info-circle"} me-2"></i>\n        ${t}\n      </div>\n    `,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}static init(){if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",()=>{(new r).checkReportedComments()});else{(new r).checkReportedComments()}}}r.init();const a=new r;export{r as ReportingSystem,a as reportingSystem};
