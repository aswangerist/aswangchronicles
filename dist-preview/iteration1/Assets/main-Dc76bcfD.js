const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/reportingSystem-BNeaGoM3.js","assets/vendor-FisM0nxI.js","assets/bootstrap-BAiwbtED.js","assets/bootstrap-BtmJYOxZ.css","assets/utils-C620QYE8.js","assets/components-QOneMgCI.js","assets/fontawesome-DX1ZCXa8.css","assets/adminSystem-Cy9qaBsD.js"])))=>i.map(i=>d[i]);
import"./bootstrap-BAiwbtED.js";/* empty css                    */import{i as e,g as t,s as n,a,c as o,q as i,l as s,b as r}from"./vendor-FisM0nxI.js";import{i as c}from"./utils-C620QYE8.js";import{A as l,C as d,a as m,G as u,H as h}from"./components-QOneMgCI.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const p={},g=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),n=e?.nonce||e?.getAttribute("nonce");o=t.map(e=>{if((e=function(e){return"/iteration1/"+e}(e))in p)return;p[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script"),o.crossOrigin="",o.href=e,n&&o.setAttribute("nonce",n),document.head.appendChild(o),t?new Promise((t,n)=>{o.addEventListener("load",t),o.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}),a=Promise.all(o.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))}var o;function i(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&i(e.reason);return e().catch(i)})};class v{constructor(e){this.routes=e,this.currentRoute=null,this.contentElement=document.getElementById("app-content")||document.body,window.addEventListener("popstate",()=>this.handleRoute()),this.handleRoute()}handleRoute(){let e=window.location.pathname;const t="/iteration1";e.startsWith(t)&&(e=e.substring(11)||"/");e={"/":"/","/game":"/game","/archives":"/archives","/contact":"/contact","/admin":"/admin"}[e]||"/";const n=this.routes[e]||this.routes["/"];if(n&&this.currentRoute!==e){this.currentRoute=e,this.loadComponent(n);const t="/"===e?"/iteration1/":`/iteration1${e}`;window.location.pathname!==t&&window.history.pushState(null,"",t)}}async loadComponent(e){try{if(this.showLoading(),"function"==typeof e){const t=await e();this.renderContent(t),this.updateActiveNavigation()}else this.renderContent(e),this.updateActiveNavigation()}catch(t){this.renderContent(this.getErrorPage())}}updateActiveNavigation(){const e=window.location.pathname;document.querySelectorAll(".nav-link").forEach(t=>{t.classList.remove("active");t.getAttribute("data-route")===e&&t.classList.add("active")})}showLoading(){this.contentElement.innerHTML='\n      <div class="loading-screen">\n        <div class="container text-center d-flex flex-column justify-content-center align-items-center" style="min-height: 100vh;">\n          <i class="fas fa-ghost fa-3x mb-4 text-danger" style="animation: float 2s ease-in-out infinite;"></i>\n          <h2 style="color: var(--red); font-family: var(--font-header);">Loading Folklore...</h2>\n          <div class="spinner-border text-danger mt-3" role="status">\n            <span class="visually-hidden">Loading...</span>\n          </div>\n        </div>\n      </div>\n    '}getErrorPage(){return'\n      <div class="error-page">\n        <div class="container text-center d-flex flex-column justify-content-center align-items-center" style="min-height: 100vh;">\n          <i class="fas fa-skull fa-4x mb-4 text-danger"></i>\n          <h1 style="color: var(--red); font-family: var(--font-header);">The Spirits Are Restless</h1>\n          <p style="color: var(--light-gray); font-size: 1.2rem;">Something went wrong in the realm of folklore.</p>\n          <button class="btn btn-primary mt-3" onclick="window.location.reload()">\n            <i class="fas fa-redo me-2"></i>Try Again\n          </button>\n        </div>\n      </div>\n    '}renderContent(e){this.contentElement&&(this.contentElement.innerHTML=e,document.body.classList.remove("loading"),window.initAnimations&&window.initAnimations(),window.initNavigation&&window.initNavigation(),"/game"===window.location.pathname&&g(()=>import("./gameControls-DrGbzb7r.js"),[]).then(e=>{e.initGameControls()}).catch(e=>{}),"/archives"===window.location.pathname&&g(()=>import("./archivesModal-Bm4BB6Ef.js"),[]).then(e=>{e.initArchivesModal()}).catch(e=>{}),g(()=>Promise.resolve().then(()=>E),void 0).then(e=>{const t=e.getLazyLoader();t&&(t.observeImages(),t.observeAnimations())}),"/game"===window.location.pathname&&document.getElementById("commentForm")&&(window.currentCommentSystem&&window.currentCommentSystem.destroy(),g(()=>Promise.resolve().then(()=>q),void 0).then(e=>{window.currentCommentSystem=new e.CommentSystem}).catch(e=>{}),g(()=>import("./reportingSystem-BNeaGoM3.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(e=>{}).catch(e=>{})),"/admin"===window.location.pathname&&(window.currentAdminSystem&&window.currentAdminSystem.destroy(),g(()=>import("./adminSystem-Cy9qaBsD.js"),__vite__mapDeps([7,1,2,3,4,5,6])).then(e=>{window.currentAdminSystem=e.initAdminPage()}).catch(e=>{})),"/game"===window.location.pathname&&document.querySelector(".share-buttons")&&g(()=>import("./share-Zij-iYey.js"),[]).then(e=>{new e.ShareSystem}).catch(e=>{}),g(()=>Promise.resolve().then(()=>C),void 0).then(e=>{const t=e.getMobileNavigation();t&&t.onRouteChange()}),window.scrollTo(0,0))}navigateTo(e){const t="/"===e?"/iteration1/":`/iteration1${e}`;window.history.pushState(null,"",t),this.handleRoute()}}let f=null;class y{constructor(){this.imageObserver=null,this.animationObserver=null,this.init()}init(){this.setupImageLazyLoading(),this.setupAnimationObserver()}setupImageLazyLoading(){this.imageObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target;this.loadImage(t),this.imageObserver.unobserve(t)}})},{rootMargin:"50px 0px",threshold:.1})}setupAnimationObserver(){this.animationObserver=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("animate-in")})},{rootMargin:"0px 0px -50px 0px",threshold:.1})}loadImage(e){const t=e.dataset.src,n=e.dataset.srcset;if(t){const a=new Image;a.onload=()=>{e.style.opacity="0",e.style.transition="opacity 0.3s ease",e.src=t,n&&(e.srcset=n),delete e.dataset.src,delete e.dataset.srcset,requestAnimationFrame(()=>{e.style.opacity="1"}),e.classList.remove("lazy-image"),e.classList.add("loaded")},a.onerror=()=>{e.src=this.getPlaceholderImage(),e.classList.add("error")},a.src=t}}getPlaceholderImage(){return"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgZmlsbD0iIzMzMzMzMyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM2NjY2NjYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg=="}observeImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.imageObserver.observe(e)})}observeAnimations(){document.querySelectorAll(".animate-on-scroll").forEach(e=>{this.animationObserver.observe(e)})}static createLazyImage(e,t="",n="",a=""){return`\n      <img \n        class="lazy-image ${n}" \n        data-src="${e}"\n        ${a?`data-srcset="${a}"`:""}\n        alt="${t}"\n        loading="lazy"\n        style="opacity: 0; transition: opacity 0.3s ease;"\n        onload="this.style.opacity = 1;"\n      />\n    `}static preloadCriticalImages(e){e.forEach(e=>{const t=document.createElement("link");t.rel="preload",t.as="image",t.href=e,document.head.appendChild(t)})}}class w{static measureImageLoad(e){const t=performance.now();return new Promise(n=>{const a=new Image;a.onload=()=>{const e=performance.now()-t;n(e)},a.src=e})}static logWebVitals(){if("undefined"!=typeof window&&"PerformanceObserver"in window){const t=new PerformanceObserver(e=>{for(const t of e.getEntries()){void 0!==t.value&&t.value.toFixed(2)}});try{t.observe({entryTypes:["measure","navigation"]})}catch(e){}}}}let b=null;function S(){return b||(b=new y),b.observeImages(),b.observeAnimations(),b}const E=Object.freeze(Object.defineProperty({__proto__:null,LazyLoader:y,PerformanceMonitor:w,getLazyLoader:function(){return b},initLazyLoading:S},Symbol.toStringTag,{value:"Module"}));class A{constructor(){this.isMenuOpen=!1,this.touchStartX=0,this.touchStartY=0,this.touchEndX=0,this.touchEndY=0,this.init()}init(){this.setupTouchGestures(),this.setupMobileMenu(),this.setupBottomNavigation(),this.setupScrollBehavior()}setupTouchGestures(){let e,t;document.addEventListener("touchstart",n=>{e=n.touches[0].clientX,t=n.touches[0].clientY},{passive:!0}),document.addEventListener("touchend",n=>{const a=n.changedTouches[0].clientX,o=n.changedTouches[0].clientY,i=a-e,s=o-t;e<50&&i>100&&Math.abs(s)<100&&this.openMobileMenu(),this.isMenuOpen&&i<-100&&Math.abs(s)<100&&this.closeMobileMenu(),s>50&&Math.abs(i)<100&&this.showNavigation(),s<-50&&Math.abs(i)<100&&this.hideNavigation()},{passive:!0})}setupMobileMenu(){document.body.insertAdjacentHTML("beforeend",'\n      <div id="mobile-menu-overlay" class="mobile-menu-overlay">\n        <div class="mobile-menu-content">\n          <div class="mobile-menu-header">\n            <img src="/Assets/WebsiteAssets/Logos/Horizontal.png" alt="Aswang Chronicles" class="mobile-logo">\n            <button class="mobile-menu-close" aria-label="Close menu">\n              <i class="fas fa-times"></i>\n            </button>\n          </div>\n          <nav class="mobile-nav-links">\n            <a href="#" data-route="/" class="mobile-nav-link">\n              <i class="fas fa-home"></i>\n              <span>Home</span>\n            </a>\n            <a href="https://aswang-chronicles.itch.io/aswang-chronicles-spoon-test" target="_blank" class="mobile-nav-link">\n              <i class="fas fa-gamepad"></i>\n              <span>Play Game</span>\n            </a>\n            <a href="#" data-route="/archives" class="mobile-nav-link">\n              <i class="fas fa-book-open"></i>\n              <span>Aswang Archives</span>\n            </a>\n            <a href="#" data-route="/contact" class="mobile-nav-link">\n              <i class="fas fa-envelope"></i>\n              <span>Contact Us</span>\n            </a>\n          </nav>\n          <div class="mobile-menu-footer">\n            <p>Preserving Filipino Folklore</p>\n            <div class="mobile-social-links">\n              <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>\n              <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>\n              <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>\n            </div>\n          </div>\n        </div>\n      </div>\n    ');const e=document.querySelector(".navbar-toggler"),t=document.querySelector(".mobile-menu-close"),n=document.querySelector("#mobile-menu-overlay");e&&e.addEventListener("click",()=>this.toggleMobileMenu()),t&&t.addEventListener("click",()=>this.closeMobileMenu()),n&&n.addEventListener("click",e=>{e.target===n&&this.closeMobileMenu()})}setupBottomNavigation(){document.body.insertAdjacentHTML("beforeend",'\n      <div id="bottom-navigation" class="bottom-navigation">\n        <a href="#" data-route="/" class="bottom-nav-item">\n          <i class="fas fa-home"></i>\n          <span>Home</span>\n        </a>\n        <a href="#" data-route="/archives" class="bottom-nav-item">\n          <i class="fas fa-book-open"></i>\n          <span>Archives</span>\n        </a>\n        <a href="https://aswang-chronicles.itch.io/aswang-chronicles-spoon-test" target="_blank" class="bottom-nav-item">\n          <i class="fas fa-gamepad"></i>\n          <span>Game</span>\n        </a>\n        <a href="#" data-route="/contact" class="bottom-nav-item">\n          <i class="fas fa-envelope"></i>\n          <span>Contact</span>\n        </a>\n      </div>\n    '),this.updateActiveBottomNav()}setupScrollBehavior(){let e=window.scrollY,t=!1;const n=()=>{const n=window.scrollY,a=document.querySelector(".navbar"),o=document.querySelector("#bottom-navigation");n>e&&n>100?(a&&(a.style.transform="translateY(-100%)"),o&&(o.style.transform="translateY(100%)")):(a&&(a.style.transform="translateY(0)"),o&&(o.style.transform="translateY(0)")),e=n,t=!1};window.addEventListener("scroll",()=>{t||(requestAnimationFrame(n),t=!0)},{passive:!0})}toggleMobileMenu(){this.isMenuOpen?this.closeMobileMenu():this.openMobileMenu()}openMobileMenu(){const e=document.querySelector("#mobile-menu-overlay");e&&(e.classList.add("active"),document.body.style.overflow="hidden",this.isMenuOpen=!0)}closeMobileMenu(){const e=document.querySelector("#mobile-menu-overlay");e&&(e.classList.remove("active"),document.body.style.overflow="",this.isMenuOpen=!1)}showNavigation(){const e=document.querySelector(".navbar"),t=document.querySelector("#bottom-navigation");e&&(e.style.transform="translateY(0)"),t&&(t.style.transform="translateY(0)")}hideNavigation(){const e=document.querySelector(".navbar"),t=document.querySelector("#bottom-navigation");e&&(e.style.transform="translateY(-100%)"),t&&(t.style.transform="translateY(100%)")}updateActiveBottomNav(){const e=window.location.pathname;document.querySelectorAll(".bottom-nav-item").forEach(t=>{t.classList.remove("active");t.getAttribute("data-route")===e&&t.classList.add("active")})}onRouteChange(){this.updateActiveBottomNav(),this.closeMobileMenu()}}let I=null;function L(){return I||(I=new A),I}const C=Object.freeze(Object.defineProperty({__proto__:null,MobileNavigation:A,getMobileNavigation:function(){return I},initMobileNavigation:L},Symbol.toStringTag,{value:"Module"})),x={apiKey:"your-production-firebase-api-key",authDomain:"your-production-project.firebaseapp.com",projectId:"your-production-project-id",storageBucket:"your-production-project.appspot.com",messagingSenderId:"987654321",appId:"your-production-app-id"},_={apiKey:"demo-api-key",authDomain:"aswang-chronicles-demo.firebaseapp.com",projectId:"aswang-chronicles-demo",storageBucket:"aswang-chronicles-demo.appspot.com",messagingSenderId:"123456789",appId:"1:123456789:web:demo"},k=x.apiKey?x:_,M=!x.apiKey;let T,P;try{T=e(k),P=t(T),M&&P._delegate}catch(B){}const O={COMMENTS:"aswang-comments",ANALYTICS:"aswang-analytics"};function N(){return navigator.onLine}function D(){return{isInitialized:!!T&&!!P,isOnline:N(),isDevelopmentMode:k===_,projectId:k.projectId}}const R=new class{constructor(){this.autoApprovalThreshold=parseInt("80")||75,this.autoRejectionThreshold=parseInt("40")||50,this.rateLimitPerHour=parseInt("3")||5,this.profanityList=["stupid","idiot","moron","dumb","hate","suck","worst","terrible","awful","horrible","disgusting","pathetic","loser","fail","trash","click here","visit my","free money","win now","buy now","discount","limited time","act now","special offer","guaranteed","amazing deal","inappropriate","offensive","harassment","bully","threat"],this.spamPatterns=[/(.)\1{4,}/g,/[A-Z]{10,}/g,/(https?:\/\/[^\s]+)/g,/(\b\w+\b)(\s+\1){2,}/gi,/[!@#$%^&*()]{5,}/g,/\b\d{4,}\b/g,/@\w+/g],this.positiveKeywords=["amazing","awesome","great","excellent","fantastic","wonderful","love","beautiful","creative","inspiring","educational","cultural","folklore","heritage","traditional","filipino","philippines","culture","story","narrative","legend","myth","aswang","interactive","engaging"]}moderateComment(e,t){const n={isApproved:!0,score:100,issues:[],flags:[],severity:"clean",autoAction:"approve"},a=this.checkPlayerName(e);a.length>0&&(n.issues.push(...a),n.score-=20);const o=this.checkCommentContent(t);o.length>0&&(n.issues.push(...o),n.score-=15*o.length);const i=this.checkSpamPatterns(t);i.length>0&&(n.issues.push(...i),n.score-=25*i.length);const s=this.checkProfanity(t);s.length>0&&(n.issues.push(...s),n.score-=30*s.length);const r=this.checkPositiveContent(t);return r>0&&(n.score=Math.min(100,n.score+r),n.flags.push("positive_content")),n.severity=this.determineSeverity(n.score),n.autoAction=this.determineAutoAction(n.score,n.issues),n.isApproved="approve"===n.autoAction,n}checkPlayerName(e){const t=[];return/^(admin|mod|test|spam|bot)/i.test(e)&&t.push("suspicious_name_pattern"),/\d{4,}/.test(e)&&t.push("excessive_numbers_in_name"),/[^a-zA-Z0-9\s]{3,}/.test(e)&&t.push("excessive_special_chars_in_name"),t}checkCommentContent(e){const t=[];e.length<20&&t.push("very_short_comment"),/[!?]{3,}/.test(e)&&t.push("excessive_punctuation");const n=(e.match(/[A-Z]/g)||[]).length,a=(e.match(/[A-Za-z]/g)||[]).length;return a>0&&n/a>.7&&t.push("excessive_caps"),t}checkSpamPatterns(e){const t=[];return this.spamPatterns.forEach(n=>{if(n.test(e))switch(n.source){case"(.)\\1{4,}":t.push("repeated_characters");break;case"[A-Z]{10,}":t.push("excessive_caps_sequence");break;case"(https?:\\/\\/[^\\s]+)":t.push("contains_url");break;case"(\\b\\w+\\b)(\\s+\\1){2,}":t.push("repeated_words");break;case"[!@#$%^&*()]{5,}":t.push("excessive_special_chars");break;case"\\b\\d{4,}\\b":t.push("contains_phone_number");break;case"@\\w+":t.push("contains_email_pattern")}}),t}checkProfanity(e){const t=[],n=e.toLowerCase();return this.profanityList.forEach(e=>{n.includes(e.toLowerCase())&&t.push(`profanity_detected_${e}`)}),t}checkPositiveContent(e){const t=e.toLowerCase();let n=0;this.positiveKeywords.forEach(e=>{t.includes(e)&&(n+=5)});return["folklore","culture","heritage","traditional","educational","filipino"].forEach(e=>{t.includes(e)&&(n+=10)}),Math.min(n,30)}determineSeverity(e){return e>=80?"clean":e>=60?"mild":e>=40?"moderate":"severe"}determineAutoAction(e,t){return t.some(e=>e.includes("profanity")||e.includes("url"))?"reject":e>=this.autoApprovalThreshold?"approve":e>=this.autoRejectionThreshold?"review":"reject"}getModerationMessage(e){if(e.isApproved)return null;const t={suspicious_name_pattern:"Please use a more appropriate display name.",excessive_caps:"Please avoid using excessive capital letters.",profanity_detected:"Please keep comments respectful and family-friendly.",contains_url:"Comments with links are not allowed for security reasons.",repeated_characters:"Please avoid repeating characters excessively.",very_short_comment:"Please write a more detailed review to help other players.",contains_phone_number:"Please don't include personal information in comments."};for(const n of e.issues)for(const[e,a]of Object.entries(t))if(n.includes(e.split("_")[0]))return a;return"Your comment needs review before it can be published. Please ensure it follows our community guidelines."}getModerationReport(e,t,n){return{timestamp:(new Date).toISOString(),playerName:t,commentText:n,score:e.score,severity:e.severity,autoAction:e.autoAction,issues:e.issues,flags:e.flags,needsReview:"review"===e.autoAction,isRejected:"reject"===e.autoAction}}};const j=document.createElement("style");j.textContent="\n  @keyframes slideIn {\n    from {\n      transform: translateX(100%);\n      opacity: 0;\n    }\n    to {\n      transform: translateX(0);\n      opacity: 1;\n    }\n  }\n",document.head.appendChild(j);const q=Object.freeze(Object.defineProperty({__proto__:null,CommentSystem:class{constructor(){this.comments=[],this.currentRating=0,this.unsubscribe=null,this.isFirebaseEnabled=!1,this.init()}async init(){await this.waitForElements(),this.setupEventListeners();const e=D();this.isFirebaseEnabled=e.isInitialized,this.updateConnectionStatus("connecting","Connecting to database..."),this.isFirebaseEnabled?(await this.setupFirestoreListener(),this.updateConnectionStatus("online","Live comments - Real-time updates")):(this.comments=this.loadCommentsFromStorage(),this.renderComments(),this.updateConnectionStatus("local","Offline mode - Local storage")),this.updateStats()}async waitForElements(){let e=0;for(;e<5e3;){const t=document.getElementById("commentsList"),n=document.getElementById("commentsEmpty"),a=document.getElementById("commentForm");if(t&&n&&a)return;await new Promise(e=>setTimeout(e,100)),e+=100}}updateConnectionStatus(e,t){const n=document.getElementById("firebaseStatus");n&&(n.className=`firebase-status ${e}`,n.querySelector(".status-text").textContent=t)}setupEventListeners(){document.addEventListener("click",e=>{e&&e.target&&"function"==typeof e.target.matches&&e.target.matches(".star")&&this.handleStarClick(e.target)}),document.addEventListener("input",e=>{e&&e.target&&"function"==typeof e.target.matches&&e.target.matches("#commentText")&&this.updateCharacterCount(e.target)}),document.addEventListener("submit",e=>{e.target.matches("#commentForm")&&(e.preventDefault(),this.handleCommentSubmission(e.target))}),document.addEventListener("mouseover",e=>{e.target.matches(".star")&&this.handleStarHover(e.target)}),document.addEventListener("mouseout",e=>{e.target.matches(".star-rating")&&this.resetStarHover()})}handleStarClick(e){const t=parseInt(e.dataset.rating);this.currentRating=t,this.updateStarDisplay(t),this.updateRatingText(t)}handleStarHover(e){const t=parseInt(e.dataset.rating);this.updateStarDisplay(t,!0)}resetStarHover(){this.updateStarDisplay(this.currentRating)}updateStarDisplay(e,t=!1){document.querySelectorAll(".star").forEach((t,n)=>{n+1<=e?t.classList.add("active"):t.classList.remove("active")})}updateRatingText(e){document.getElementById("ratingText").textContent={1:"Poor - Needs improvement",2:"Fair - Could be better",3:"Good - Enjoyable experience",4:"Very Good - Really liked it",5:"Excellent - Absolutely amazing!"}[e]||"Click to rate"}updateCharacterCount(e){const t=document.getElementById("charCount"),n=e.value.length;t.textContent=n,t.style.color=n>450?"var(--red)":n>400?"var(--yellow)":"var(--light-green)"}async handleCommentSubmission(e){new FormData(e);const t=document.getElementById("playerName").value.trim(),a=document.getElementById("commentText").value.trim(),o=document.getElementById("favoriteAspect").value;if(!t||!a||0===this.currentRating)return void this.showNotification("Please fill in all required fields and provide a rating.","error");if(a.length<10)return void this.showNotification("Please write a more detailed review (at least 10 characters).","error");const i=R.moderateComment(t,a);if(!i.isApproved){const e=R.getModerationMessage(i);return void this.showNotification(e||"Comment violates community guidelines","error")}const s={playerName:this.sanitizeInput(t),commentText:this.sanitizeInput(a),rating:this.currentRating,favoriteAspect:o,timestamp:Date.now(),createdAt:this.isFirebaseEnabled?n():(new Date).toISOString(),moderation:{score:i.score,severity:i.severity,flags:i.flags,approved:i.isApproved,reviewedAt:(new Date).toISOString()},status:"review"===i.autoAction?"pending_review":"approved"};try{this.isFirebaseEnabled&&N()?(await this.saveCommentToFirestore(s),"pending_review"===s.status?this.showNotification("Thank you for your review! It is awaiting moderation and will appear once approved.","info"):this.showNotification("Thank you for your review! Your feedback helps improve our game.","success")):(s.id=Date.now().toString(),s.date=(new Date).toISOString(),s.status="approved",this.comments.unshift(s),this.saveCommentsToStorage(),this.renderComments(),this.updateStats(),this.showNotification("Review saved locally. It will sync when you're back online.","success")),this.resetForm()}catch(B){this.showNotification("Failed to save review. Please try again.","error")}}async saveCommentToFirestore(e){try{return(await a(o(P,O.COMMENTS),e)).id}catch(B){throw new Error(function(e){return{"permission-denied":"You don't have permission to perform this action.",unavailable:"Service is currently unavailable. Please try again later.","failed-precondition":"The operation failed due to a conflict.","already-exists":"This item already exists.","not-found":"The requested item was not found.","invalid-argument":"Invalid data provided.","deadline-exceeded":"The operation took too long. Please try again.",unauthenticated:"Authentication required for this operation."}[e.code]||"An unexpected error occurred. Please try again."}(B))}}async setupFirestoreListener(){try{const e=i(o(P,O.COMMENTS),s(50)),t=await r(e),n=[];t.forEach(e=>{const t=e.data();n.push({id:e.id,...t,date:t.createdAt?.toDate?.()?.toISOString()||t.createdAt||(new Date).toISOString(),timestamp:t.createdAt?.toDate?.()?.getTime()||t.timestamp||Date.now()})}),n.sort((e,t)=>t.timestamp-e.timestamp),this.comments=n,this.renderComments(),this.updateStats(),this.updateConnectionStatus("online",`Comments loaded (${n.length} reviews)`)}catch(B){this.updateConnectionStatus("offline","Failed to connect - Using offline data"),this.comments=this.loadCommentsFromStorage(),this.renderComments(),this.updateStats()}}sanitizeInput(e){return e.replace(/[<>]/g,"")}resetForm(){document.getElementById("commentForm").reset(),this.currentRating=0,this.updateStarDisplay(0),this.updateRatingText(0),document.getElementById("charCount").textContent="0",document.getElementById("charCount").style.color="var(--light-green)"}renderComments(){const e=document.getElementById("commentsList"),t=document.getElementById("commentsEmpty");if(!e||!t)return;const n=this.comments.filter(e=>!e.status||"approved"===e.status||"pending_review"===e.status);if(0===n.length)return e.style.display="none",void(t.style.display="block");e.style.display="block",t.style.display="none",e.innerHTML=n.map(e=>this.renderComment(e)).join(""),setTimeout(()=>{window.initScrollAnimations&&window.initScrollAnimations()},100)}renderComment(e){const t=new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=Array.from({length:5},(t,n)=>`<span class="star${n<e.rating?" active":""}">★</span>`).join(""),a=e.favoriteAspect?`<span class="favorite-aspect">${{story:"Engaging Storyline",choices:"Multiple Choice Paths",folklore:"Filipino Folklore Elements",characters:"Character Development",atmosphere:"Atmosphere & Design",educational:"Educational Value"}[e.favoriteAspect]}</span>`:"",o="pending_review"===e.status,i=o?'<span class="badge bg-warning text-dark ms-2"><i class="fas fa-clock"></i> Pending Review</span>':"";return`\n      <div class="comment-item animate-on-scroll ${o?"opacity-75 border-warning":""}">\n        <div class="comment-header">\n          <div class="comment-author">\n            <div class="author-avatar">${e.playerName.charAt(0).toUpperCase()}</div>\n            <div>\n              <div class="author-name">\n                ${e.playerName}\n                ${i}\n              </div>\n              <div class="comment-rating">${n}</div>\n            </div>\n          </div>\n          <div class="comment-date">${t}</div>\n        </div>\n        <div class="comment-text ${o?"text-muted":""}">${e.commentText}</div>\n        <div class="comment-meta">\n          <div>${a}</div>\n          <div>Rating: ${e.rating}/5 stars</div>\n          ${o?'<div class="text-warning"><i class="fas fa-info-circle"></i> This review is awaiting moderation</div>':""}\n        </div>\n      </div>\n    `}updateStats(){const e=this.comments.length,t=e>0?(this.comments.reduce((e,t)=>e+t.rating,0)/e).toFixed(1):0,n=e>0?Math.round(this.comments.filter(e=>e.rating>=4).length/e*100):0,a=document.getElementById("totalComments"),o=document.getElementById("averageRating"),i=document.getElementById("recommendPercent");a&&(a.textContent=e),o&&(o.textContent=t),i&&(i.textContent=`${n}%`)}showNotification(e,t="info"){const n=document.querySelector(".comment-notification");n&&n.remove();const a=document.createElement("div");a.className=`comment-notification ${t}`,a.innerHTML=`\n      <div style="\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: ${"success"===t?"var(--dark-green)":"var(--red)"};\n        color: white;\n        padding: 1rem 1.5rem;\n        border-radius: 10px;\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n        z-index: 10000;\n        font-family: var(--font-body);\n        max-width: 300px;\n        animation: slideIn 0.3s ease;\n      ">\n        <i class="fas fa-${"success"===t?"check-circle":"exclamation-triangle"} me-2"></i>\n        ${e}\n      </div>\n    `,document.body.appendChild(a),setTimeout(()=>{a.parentNode&&a.remove()},5e3)}loadCommentsFromStorage(){try{const e=localStorage.getItem("aswang-chronicles-comments");return e?JSON.parse(e):this.getDefaultComments()}catch(B){return this.getDefaultComments()}}saveCommentsToStorage(){try{localStorage.setItem("aswang-chronicles-comments",JSON.stringify(this.comments))}catch(B){}}destroy(){this.unsubscribe&&this.unsubscribe()}getDefaultComments(){return[{id:"1",playerName:"Maria Santos",commentText:"Amazing interactive experience! The way Filipino folklore is presented is both educational and engaging. The multiple choice paths really make you think about the consequences of your decisions.",rating:5,favoriteAspect:"folklore",date:new Date(Date.now()-1728e5).toISOString(),timestamp:Date.now()-1728e5},{id:"2",playerName:"Carlos Rivera",commentText:"Great concept and execution! Love how it preserves our cultural stories in a modern format. The atmosphere design really captures the mysterious essence of aswang legends.",rating:4,favoriteAspect:"atmosphere",date:new Date(Date.now()-432e6).toISOString(),timestamp:Date.now()-432e6},{id:"3",playerName:"Anna Chen",commentText:"As someone not familiar with Filipino folklore, this was an excellent introduction. The educational value is incredible while still being entertaining.",rating:5,favoriteAspect:"educational",date:new Date(Date.now()-6048e5).toISOString(),timestamp:Date.now()-6048e5}]}}},Symbol.toStringTag,{value:"Module"}));const F=function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:a,onRegistered:o,onRegisteredSW:i,onRegisterError:s}=e;let r,c;return c=async function(){if("serviceWorker"in navigator){if(r=await g(async()=>{const{Workbox:e}=await import("./vendor-FisM0nxI.js").then(e=>e.f);return{Workbox:e}},[]).then(({Workbox:e})=>new e("/iteration1/sw.js",{scope:"/iteration1/",type:"classic"})).catch(e=>{s?.(e)}),!r)return;r.addEventListener("activated",e=>{(e.isUpdate||e.isExternal)&&window.location.reload()}),r.addEventListener("installed",e=>{e.isUpdate||a?.()}),r.register({immediate:t}).then(e=>{i?i("/iteration1/sw.js",e):o?.(e)}).catch(e=>{s?.(e)})}}(),async(e=!0)=>{await c}}({onNeedRefresh(){confirm("New content available. Reload to update?")&&F(!0)},onOfflineReady(){!function(){const e=document.createElement("div");e.innerHTML='\n    <div class="pwa-notification" style="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: var(--red);\n      color: white;\n      padding: 1rem;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(189, 3, 0, 0.3);\n      z-index: 10000;\n      font-family: var(--font-body);\n      max-width: 300px;\n    ">\n      <i class="fas fa-ghost me-2"></i>\n      <strong>Offline Ready!</strong><br>\n      <small>Aswang Chronicles is now available offline</small>\n      <button onclick="this.parentElement.parentElement.remove()" style="\n        background: none;\n        border: none;\n        color: white;\n        float: right;\n        font-size: 1.2rem;\n        cursor: pointer;\n        margin-top: -5px;\n      ">&times;</button>\n    </div>\n  ',document.body.appendChild(e),setTimeout(()=>{e.parentElement&&e.remove()},5e3)}()}});document.addEventListener("DOMContentLoaded",()=>{!function(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector(this.getAttribute("href"));t&&t.scrollIntoView({behavior:"smooth",block:"start"})})});const e=document.querySelector(".navbar-toggler"),t=document.querySelector(".navbar-collapse");e&&t&&e.addEventListener("click",()=>{t.classList.toggle("show")}),document.addEventListener("click",e=>{if(!e||!e.target||"function"!=typeof e.target.closest)return;const t=e.target.closest("[data-route]");if(t){e.preventDefault();const n=t.getAttribute("data-route");window.router?window.router.navigateTo(n):(window.history.pushState({},"",n),window.dispatchEvent(new PopStateEvent("popstate")))}})}(),function(){window.addEventListener("scroll",()=>{const e=window.pageYOffset;document.querySelectorAll(".floating-element").forEach(t=>{const n=-.5*e;t.style.transform=`translateY(${n}px)`})});const e=document.querySelector(".hero-main-title");e&&function(e,t,n=100){let a=0;e.innerHTML="",function o(){a<t.length&&(e.innerHTML+=t.charAt(a),a++,setTimeout(o,n))}()}(e,e.textContent,150);const t=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("animate-in")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll(".mission-vision-card, .about-image").forEach(e=>{t.observe(e)})}(),S(),L(),function(){let e=document.getElementById("backToTop");function t(){e=document.getElementById("backToTop"),e&&(window.pageYOffset>300?e.classList.add("visible"):e.classList.remove("visible"))}function n(){window.scrollTo({top:0,behavior:"smooth"})}window.addEventListener("scroll",t),document.addEventListener("click",e=>{e&&e.target&&"function"==typeof e.target.closest&&e.target.closest("#backToTop")&&(e.preventDefault(),n())}),t()}(),function(){const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("animated")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});function t(){document.querySelectorAll(".animate-on-scroll").forEach(t=>e.observe(t))}new MutationObserver(()=>{t()}).observe(document.body,{childList:!0,subtree:!0}),t()}(),c(),w.logWebVitals(),f=new v({"/":h,"/game":u,"/archives":m,"/contact":d,"/admin":l}),window.router=f,document.addEventListener("click",e=>{if(!e||!e.target||"function"!=typeof e.target.closest)return;const t=e.target.closest(".game-embed-overlay");if(t){t.style.opacity="0",t.style.pointerEvents="none";const e=t.parentElement.querySelector(".game-embed-iframe");e&&e.focus()}}),document.addEventListener("click",e=>{e&&e.target&&"function"==typeof e.target.closest&&!e.target.closest(".game-embed-container")&&document.querySelectorAll(".game-embed-overlay").forEach(e=>{e.style.opacity="",e.style.pointerEvents=""})}),setTimeout(()=>{},2e3)});export{O as C,P as d,D as g};
